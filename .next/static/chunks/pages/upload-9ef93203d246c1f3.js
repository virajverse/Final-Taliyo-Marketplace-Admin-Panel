(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[863],{1004:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/upload",function(){return t(5365)}])},6880:function(e,s,t){"use strict";t.d(s,{Z:function(){return w}});var a=t(5893),l=t(7294),r=t(1664),i=t.n(r),n=t(1163),c=t(8979),d=t(3283),o=t(3633),m=t(5237),x=t(3156),h=t(9176),u=t(5928),g=t(5264),p=t(2190),j=e=>{let{isOpen:s,onClose:t}=e,l=(0,n.useRouter)(),r=[{name:"Dashboard",href:"/",icon:c.Z},{name:"Upload Data",href:"/upload",icon:d.Z},{name:"Click Tracking",href:"/tracking",icon:o.Z},{name:"Manage Categories",href:"/manage-categories",icon:m.Z},{name:"Manage Items",href:"/manage-items",icon:x.Z},{name:"Manage Admins",href:"/manage-admins",icon:h.Z},{name:"Analytics",href:"/analytics",icon:u.Z},{name:"Settings",href:"/settings",icon:g.Z}];return(0,a.jsxs)(a.Fragment,{children:[s&&(0,a.jsx)("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-50 lg:hidden",onClick:t}),(0,a.jsxs)("div",{className:"\n        fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out\n        lg:translate-x-0 lg:static lg:inset-0\n        ".concat(s?"translate-x-0":"-translate-x-full","\n      "),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between h-16 px-6 border-b border-gray-200",children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-primary-600",children:"Taliyo Admin"}),(0,a.jsx)("button",{onClick:t,className:"lg:hidden p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100",children:(0,a.jsx)(p.Z,{size:20})})]}),(0,a.jsx)("nav",{className:"flex-1 px-4 py-6 space-y-2",children:r.map(e=>{let s=l.pathname===e.href;return(0,a.jsxs)(i(),{href:e.href,className:"\n                  flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200\n                  ".concat(s?"bg-primary-50 text-primary-600 border-r-2 border-primary-600":"text-gray-700 hover:bg-gray-100 hover:text-gray-900","\n                "),onClick:()=>t(),children:[(0,a.jsx)(e.icon,{size:20,className:"mr-3"}),e.name]},e.name)})}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,a.jsx)("div",{className:"text-xs text-gray-500 text-center",children:"Taliyo Admin Panel v1.0"})})]})]})},y=t(8497),f=t(7918),b=t(8267),N=t(775),v=t(4231),k=e=>{var s;let{onMenuClick:t,user:r}=e,[i,c]=(0,l.useState)(!1),d=(0,n.useRouter)(),o=()=>{try{(0,v.Jn)(),d.push("/login")}catch(e){console.error("Sign out error:",e)}};return(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16 px-6",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("button",{onClick:t,className:"p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 lg:hidden",children:(0,a.jsx)(y.Z,{size:20})}),(0,a.jsxs)("div",{className:"ml-4 lg:ml-0",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Welcome back, Admin"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Manage your Taliyo marketplace"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("button",{className:"p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 relative",children:[(0,a.jsx)(f.Z,{size:20}),(0,a.jsx)("span",{className:"absolute top-1 right-1 h-2 w-2 bg-red-500 rounded-full"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>c(!i),className:"flex items-center space-x-2 p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)("div",{className:"h-8 w-8 bg-primary-500 rounded-full flex items-center justify-center",children:(0,a.jsx)(b.Z,{size:16,className:"text-white"})}),(0,a.jsx)("span",{className:"hidden md:block text-sm font-medium text-gray-700",children:(null==r?void 0:null===(s=r.email)||void 0===s?void 0:s.split("@")[0])||"Admin"})]}),i&&(0,a.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-50",children:(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsxs)("div",{className:"px-4 py-2 text-sm text-gray-700 border-b border-gray-100",children:[(0,a.jsx)("div",{className:"font-medium",children:null==r?void 0:r.email}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Administrator"})]}),(0,a.jsxs)("button",{onClick:()=>{c(!1),d.push("/settings")},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)(g.Z,{size:16,className:"mr-2"}),"Settings"]}),(0,a.jsxs)("button",{onClick:()=>{c(!1),o()},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)(N.Z,{size:16,className:"mr-2"}),"Sign out"]})]})})]})]})]})})},w=e=>{let{children:s,user:t}=e,[r,i]=(0,l.useState)(!1);return(0,a.jsxs)("div",{className:"flex h-screen bg-gray-100",children:[(0,a.jsx)(j,{isOpen:r,onClose:()=>i(!1)}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,a.jsx)(k,{onMenuClick:()=>i(!0),user:t}),(0,a.jsx)("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-6",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto",children:s})})]})]})}},6259:function(e,s,t){"use strict";t.d(s,{O:function(){return c}});var a=t(4941),l=t(3454);let r="https://tbouqkdpsdkixrjfbukd.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRib3Vxa2Rwc2RraXhyamZidWtkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5NzU2MjQsImV4cCI6MjA3NTU1MTYyNH0.S7wo-mtBlIAO52Er72FSn7uyKZwqyzVvnz-46ik22Kg",n=l.env.SUPABASE_SERVICE_ROLE_KEY;if(!r||!i)throw Error("Missing Supabase environment variables");let c=(0,a.eI)(r,n||i,{auth:{autoRefreshToken:!1,persistSession:!1}});n&&(0,a.eI)(r,n,{auth:{autoRefreshToken:!1,persistSession:!1}})},8655:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(1134).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3050:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(1134).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5365:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return j}});var a=t(5893),l=t(6880),r=t(7294);let i=(0,t(1134).Z)("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);var n=t(3283),c=t(2190),d=t(8655),o=t(3050),m=t(4105);let x=e=>new Promise((s,t)=>{let a=new FileReader;a.onload=e=>{try{let t=e.target.result,a=m.ij(t,{type:"array"}),l={};a.SheetNames.forEach(e=>{let s=a.Sheets[e],t=m.P6.sheet_to_json(s,{header:1});if(t.length>0){let s=t[0],a=t.slice(1);l[e.toLowerCase()]=a.map(e=>{let t={};return s.forEach((s,a)=>{s&&void 0!==e[a]&&(t[s.toLowerCase().replace(/\s+/g,"_")]=e[a])}),t}).filter(e=>Object.keys(e).length>0)}}),s(l)}catch(e){t(e)}},a.onerror=()=>t(Error("Failed to read file")),a.readAsArrayBuffer(e)}),h=e=>{let s=["title","description","category"],t=[];return e.forEach((e,a)=>{s.forEach(s=>{e[s]&&""!==e[s].toString().trim()||t.push("Row ".concat(a+2,": Missing ").concat(s))})}),t},u=(e,s)=>e.map(e=>({...e,type:s,whatsapp_link:e.whatsapp_link||"",is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}));var g=t(6259),p=()=>{let[e,s]=(0,r.useState)(null),[t,l]=(0,r.useState)(!1),[m,p]=(0,r.useState)(null),[j,y]=(0,r.useState)([]),[f,b]=(0,r.useState)(""),N=async e=>{let t=e.target.files[0];if(t){if(!t.name.endsWith(".xlsx")&&!t.name.endsWith(".xls")){y(["Please select a valid Excel file (.xlsx or .xls)"]);return}s(t),y([]),b("");try{let e=await x(t);p(e)}catch(e){y(["Failed to parse Excel file: ".concat(e.message)])}}},v=async()=>{if(m){l(!0),y([]),b("");try{let e=0;for(let[s,t]of Object.entries(m)){if(0===t.length)continue;let a="service";s.includes("product")?a="product":s.includes("package")&&(a="package");let l=h(t);if(l.length>0){y(e=>[...e,...l]);continue}let r=u(t,a),{data:i,error:n}=await g.O.from("items").insert(r).select();n?y(e=>[...e,"Failed to insert ".concat(s,": ").concat(n.message)]):e+=i.length}e>0&&(b("Successfully uploaded ".concat(e," items!")),s(null),p(null),document.getElementById("file-upload").value="")}catch(e){y(["Upload failed: ".concat(e.message)])}finally{l(!1)}}};return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Upload Excel Data"}),(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary-400 transition-colors",children:[(0,a.jsx)(i,{size:48,className:"mx-auto text-gray-400 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload Excel File"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"Supports .xlsx and .xls files with sheets for services, products, and packages"}),(0,a.jsx)("input",{id:"file-upload",type:"file",accept:".xlsx,.xls",onChange:N,className:"hidden"}),(0,a.jsxs)("label",{htmlFor:"file-upload",className:"btn-primary cursor-pointer inline-flex items-center",children:[(0,a.jsx)(n.Z,{size:16,className:"mr-2"}),"Choose File"]})]}),e&&(0,a.jsx)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(i,{size:20,className:"text-blue-500 mr-2"}),(0,a.jsx)("span",{className:"text-sm text-blue-800",children:e.name})]}),(0,a.jsx)("button",{onClick:()=>{s(null),p(null),y([]),b(""),document.getElementById("file-upload").value=""},className:"text-blue-500 hover:text-blue-700",children:(0,a.jsx)(c.Z,{size:16})})]})}),m&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Data Preview"}),Object.entries(m).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h4",{className:"text-md font-medium text-gray-700 mb-2 capitalize",children:[s," (",t.length," items)"]}),t.length>0&&(0,a.jsxs)("div",{className:"overflow-x-auto",children:[(0,a.jsxs)("table",{className:"min-w-full border border-gray-200 rounded-lg",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsx)("tr",{children:Object.keys(t[0]).slice(0,5).map(e=>(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:e.replace(/_/g," ")},e))})}),(0,a.jsx)("tbody",{children:t.slice(0,3).map((e,s)=>(0,a.jsx)("tr",{className:"border-t",children:Object.values(e).slice(0,5).map((e,s)=>(0,a.jsxs)("td",{className:"px-4 py-2 text-sm text-gray-900",children:[String(e).slice(0,50),String(e).length>50&&"..."]},s))},s))})]}),t.length>3&&(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["And ",t.length-3," more items..."]})]})]},s)}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{onClick:v,disabled:t,className:"btn-primary ".concat(t?"opacity-50 cursor-not-allowed":""),children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"loading-spinner mr-2"}),"Uploading..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.Z,{size:16,className:"mr-2"}),"Upload Data"]})})})]}),j.length>0&&(0,a.jsx)("div",{className:"mt-4 alert-error",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(d.Z,{size:20,className:"mr-2 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium",children:"Upload Errors:"}),(0,a.jsx)("ul",{className:"mt-1 list-disc list-inside space-y-1",children:j.map((e,s)=>(0,a.jsx)("li",{className:"text-sm",children:e},s))})]})]})}),f&&(0,a.jsx)("div",{className:"mt-4 alert-success",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(o.Z,{size:20,className:"mr-2"}),f]})})]})})},j=e=>{let{user:s}=e;return s?(0,a.jsx)(l.Z,{user:s,children:(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Upload Data"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Upload Excel files to add services, products, and packages to your marketplace."})]}),(0,a.jsx)(p,{}),(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg border border-blue-200 p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-blue-900 mb-4",children:"Excel Format Guidelines"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-blue-800 mb-2",children:"Required Columns:"}),(0,a.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"title"})," - Item name"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"description"})," - Item description"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"category"})," - Item category"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"price"})," - Item price (optional)"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"whatsapp_link"})," - WhatsApp contact link"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-blue-800 mb-2",children:"Sheet Names:"}),(0,a.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"services"})," - For service listings"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"products"})," - For product listings"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"packages"})," - For package deals"]})]})]})]}),(0,a.jsx)("div",{className:"mt-4 p-4 bg-blue-100 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,a.jsx)("strong",{children:"Tip:"})," Make sure your Excel file has proper headers in the first row. The system will automatically detect the sheet type based on the sheet name."]})})]})]})}):null}},67:function(){},2061:function(){}},function(e){e.O(0,[251,941,736,888,774,179],function(){return e(e.s=1004)}),_N_E=e.O()}]);