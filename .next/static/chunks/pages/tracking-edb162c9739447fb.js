(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[337],{3415:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tracking",function(){return s(9449)}])},6880:function(e,t,s){"use strict";s.d(t,{Z:function(){return k}});var a=s(5893),i=s(7294),r=s(1664),n=s.n(r),l=s(1163),d=s(8979),c=s(3283),o=s(3633),x=s(5237),m=s(3156),h=s(9176),u=s(5928),g=s(5264),p=s(2190),v=e=>{let{isOpen:t,onClose:s}=e,i=(0,l.useRouter)(),r=[{name:"Dashboard",href:"/",icon:d.Z},{name:"Upload Data",href:"/upload",icon:c.Z},{name:"Click Tracking",href:"/tracking",icon:o.Z},{name:"Manage Categories",href:"/manage-categories",icon:x.Z},{name:"Manage Items",href:"/manage-items",icon:m.Z},{name:"Manage Admins",href:"/manage-admins",icon:h.Z},{name:"Analytics",href:"/analytics",icon:u.Z},{name:"Settings",href:"/settings",icon:g.Z}];return(0,a.jsxs)(a.Fragment,{children:[t&&(0,a.jsx)("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-50 lg:hidden",onClick:s}),(0,a.jsxs)("div",{className:"\n        fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out\n        lg:translate-x-0 lg:static lg:inset-0\n        ".concat(t?"translate-x-0":"-translate-x-full","\n      "),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between h-16 px-6 border-b border-gray-200",children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-primary-600",children:"Taliyo Admin"}),(0,a.jsx)("button",{onClick:s,className:"lg:hidden p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100",children:(0,a.jsx)(p.Z,{size:20})})]}),(0,a.jsx)("nav",{className:"flex-1 px-4 py-6 space-y-2",children:r.map(e=>{let t=i.pathname===e.href;return(0,a.jsxs)(n(),{href:e.href,className:"\n                  flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200\n                  ".concat(t?"bg-primary-50 text-primary-600 border-r-2 border-primary-600":"text-gray-700 hover:bg-gray-100 hover:text-gray-900","\n                "),onClick:()=>s(),children:[(0,a.jsx)(e.icon,{size:20,className:"mr-3"}),e.name]},e.name)})}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,a.jsx)("div",{className:"text-xs text-gray-500 text-center",children:"Taliyo Admin Panel v1.0"})})]})]})},y=s(8497),j=s(7918),f=s(8267),b=s(775),N=s(4231),w=e=>{var t;let{onMenuClick:s,user:r}=e,[n,d]=(0,i.useState)(!1),c=(0,l.useRouter)(),o=()=>{try{(0,N.Jn)(),c.push("/login")}catch(e){console.error("Sign out error:",e)}};return(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16 px-6",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("button",{onClick:s,className:"p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 lg:hidden",children:(0,a.jsx)(y.Z,{size:20})}),(0,a.jsxs)("div",{className:"ml-4 lg:ml-0",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Welcome back, Admin"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Manage your Taliyo marketplace"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("button",{className:"p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 relative",children:[(0,a.jsx)(j.Z,{size:20}),(0,a.jsx)("span",{className:"absolute top-1 right-1 h-2 w-2 bg-red-500 rounded-full"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>d(!n),className:"flex items-center space-x-2 p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)("div",{className:"h-8 w-8 bg-primary-500 rounded-full flex items-center justify-center",children:(0,a.jsx)(f.Z,{size:16,className:"text-white"})}),(0,a.jsx)("span",{className:"hidden md:block text-sm font-medium text-gray-700",children:(null==r?void 0:null===(t=r.email)||void 0===t?void 0:t.split("@")[0])||"Admin"})]}),n&&(0,a.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-50",children:(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsxs)("div",{className:"px-4 py-2 text-sm text-gray-700 border-b border-gray-100",children:[(0,a.jsx)("div",{className:"font-medium",children:null==r?void 0:r.email}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Administrator"})]}),(0,a.jsxs)("button",{onClick:()=>{d(!1),c.push("/settings")},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)(g.Z,{size:16,className:"mr-2"}),"Settings"]}),(0,a.jsxs)("button",{onClick:()=>{d(!1),o()},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)(b.Z,{size:16,className:"mr-2"}),"Sign out"]})]})})]})]})]})})},k=e=>{let{children:t,user:s}=e,[r,n]=(0,i.useState)(!1);return(0,a.jsxs)("div",{className:"flex h-screen bg-gray-100",children:[(0,a.jsx)(v,{isOpen:r,onClose:()=>n(!1)}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,a.jsx)(w,{onMenuClick:()=>n(!0),user:s}),(0,a.jsx)("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-6",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto",children:t})})]})]})}},6259:function(e,t,s){"use strict";s.d(t,{O:function(){return d}});var a=s(4941),i=s(3454);let r="https://tbouqkdpsdkixrjfbukd.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRib3Vxa2Rwc2RraXhyamZidWtkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5NzU2MjQsImV4cCI6MjA3NTU1MTYyNH0.S7wo-mtBlIAO52Er72FSn7uyKZwqyzVvnz-46ik22Kg",l=i.env.SUPABASE_SERVICE_ROLE_KEY;if(!r||!n)throw Error("Missing Supabase environment variables");let d=(0,a.eI)(r,l||n,{auth:{autoRefreshToken:!1,persistSession:!1}});l&&(0,a.eI)(r,l,{auth:{autoRefreshToken:!1,persistSession:!1}})},7935:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},4489:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("MousePointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]])},437:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1134).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},9449:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var a=s(5893),i=s(7294),r=s(6880),n=s(1134);let l=(0,n.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var d=s(4489),c=s(437),o=s(3633),x=s(7935);let m=(0,n.Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var h=s(5928),u=s(6259),g=e=>{var t,s;let{user:n}=e,[g,p]=(0,i.useState)([]),[v,y]=(0,i.useState)([]),[j,f]=(0,i.useState)(!0),[b,N]=(0,i.useState)("all"),[w,k]=(0,i.useState)("7"),[S,C]=(0,i.useState)({totalClicks:0,todayClicks:0,topItem:null});(0,i.useEffect)(()=>{n&&Z()},[n,w]),(0,i.useEffect)(()=>{I()},[g,b]);let Z=async()=>{try{var e;let t=new Date;t.setDate(t.getDate()-parseInt(w));let{data:s,error:a}=await u.O.from("order_clicks").select("\n          *,\n          items (\n            id,\n            title,\n            type,\n            category,\n            whatsapp_link\n          )\n        ").gte("created_at",t.toISOString()).order("created_at",{ascending:!1});if(a)throw a;p(s||[]);let i=new Date;i.setHours(0,0,0,0);let r=(null==s?void 0:s.filter(e=>new Date(e.created_at)>=i).length)||0,n={};null==s||s.forEach(e=>{if(e.items){let t=e.items.id;n[t]=(n[t]||0)+1}});let l=Object.keys(n).reduce((e,t)=>n[e]>n[t]?e:t,null),d=null==s?void 0:null===(e=s.find(e=>{var t;return(null===(t=e.items)||void 0===t?void 0:t.id.toString())===l}))||void 0===e?void 0:e.items;C({totalClicks:(null==s?void 0:s.length)||0,todayClicks:r,topItem:d})}catch(e){console.error("Error loading click data:",e)}finally{f(!1)}},I=()=>{"all"===b?y(g):y(g.filter(e=>{var t;return(null===(t=e.items)||void 0===t?void 0:t.type)===b}))};return n?(0,a.jsx)(r.Z,{user:n,children:(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Click Tracking"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Monitor WhatsApp order clicks and user engagement."})]}),(0,a.jsxs)("button",{onClick:()=>{let e=new Blob([[["Date","Time","Item Title","Type","Category"],...v.map(e=>{var t,s,a;return[new Date(e.created_at).toLocaleDateString(),new Date(e.created_at).toLocaleTimeString(),(null===(t=e.items)||void 0===t?void 0:t.title)||"Unknown",(null===(s=e.items)||void 0===s?void 0:s.type)||"Unknown",(null===(a=e.items)||void 0===a?void 0:a.category)||"Unknown"]})].map(e=>e.join(",")).join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="click-tracking-".concat(new Date().toISOString().split("T")[0],".csv"),s.click(),window.URL.revokeObjectURL(t)},className:"btn-secondary flex items-center",children:[(0,a.jsx)(l,{size:16,className:"mr-2"}),"Export CSV"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Clicks"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:j?(0,a.jsx)("div",{className:"h-8 w-16 bg-gray-200 rounded animate-pulse"}):S.totalClicks.toLocaleString()})]}),(0,a.jsx)("div",{className:"bg-blue-500 p-3 rounded-lg",children:(0,a.jsx)(d.Z,{size:24,className:"text-white"})})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Today's Clicks"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:j?(0,a.jsx)("div",{className:"h-8 w-16 bg-gray-200 rounded animate-pulse"}):S.todayClicks.toLocaleString()})]}),(0,a.jsx)("div",{className:"bg-green-500 p-3 rounded-lg",children:(0,a.jsx)(c.Z,{size:24,className:"text-white"})})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Top Item"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900 mt-2",children:j?(0,a.jsx)("div",{className:"h-6 w-24 bg-gray-200 rounded animate-pulse"}):(null===(s=S.topItem)||void 0===s?void 0:null===(t=s.title)||void 0===t?void 0:t.slice(0,20))+"..."})]}),(0,a.jsx)("div",{className:"bg-purple-500 p-3 rounded-lg",children:(0,a.jsx)(o.Z,{size:24,className:"text-white"})})]})})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(x.Z,{size:16,className:"text-gray-500"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Filters:"})]}),(0,a.jsxs)("select",{value:b,onChange:e=>N(e.target.value),className:"form-input w-auto",children:[(0,a.jsx)("option",{value:"all",children:"All Types"}),(0,a.jsx)("option",{value:"service",children:"Services"}),(0,a.jsx)("option",{value:"product",children:"Products"}),(0,a.jsx)("option",{value:"package",children:"Packages"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(m,{size:16,className:"text-gray-500"}),(0,a.jsxs)("select",{value:w,onChange:e=>k(e.target.value),className:"form-input w-auto",children:[(0,a.jsx)("option",{value:"1",children:"Last 24 hours"}),(0,a.jsx)("option",{value:"7",children:"Last 7 days"}),(0,a.jsx)("option",{value:"30",children:"Last 30 days"}),(0,a.jsx)("option",{value:"90",children:"Last 90 days"})]})]})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Recent Clicks"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Showing ",v.length," clicks"]})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:j?(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"loading-spinner mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading click data..."})]}):v.length>0?(0,a.jsxs)("table",{className:"table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Date & Time"}),(0,a.jsx)("th",{children:"Item"}),(0,a.jsx)("th",{children:"Type"}),(0,a.jsx)("th",{children:"Category"}),(0,a.jsx)("th",{children:"Actions"})]})}),(0,a.jsx)("tbody",{children:v.map((e,t)=>{var s,i,r,n,l,d;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:new Date(e.created_at).toLocaleDateString()}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleTimeString()})]})}),(0,a.jsx)("td",{children:(0,a.jsx)("div",{className:"font-medium",children:(null===(s=e.items)||void 0===s?void 0:s.title)||"Unknown Item"})}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat((null===(i=e.items)||void 0===i?void 0:i.type)==="service"?"bg-blue-100 text-blue-800":(null===(r=e.items)||void 0===r?void 0:r.type)==="product"?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"),children:(null===(n=e.items)||void 0===n?void 0:n.type)||"Unknown"})}),(0,a.jsx)("td",{children:(null===(l=e.items)||void 0===l?void 0:l.category)||"Uncategorized"}),(0,a.jsx)("td",{children:(null===(d=e.items)||void 0===d?void 0:d.whatsapp_link)&&(0,a.jsx)("a",{href:e.items.whatsapp_link,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:text-green-800 text-sm",children:"View WhatsApp"})})]},t)})})]}):(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)(h.Z,{size:48,className:"mx-auto text-gray-300 mb-3"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No click data found"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Click tracking will appear here once users start clicking on items"})]})})]})]})}):null}}},function(e){e.O(0,[941,736,888,774,179],function(){return e(e.s=3415)}),_N_E=e.O()}]);