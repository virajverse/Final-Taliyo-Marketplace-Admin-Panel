(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[121],{2738:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage-admins",function(){return t(7857)}])},6880:function(e,s,t){"use strict";t.d(s,{Z:function(){return k}});var a=t(5893),i=t(7294),r=t(1664),n=t.n(r),l=t(1163),d=t(8979),c=t(3283),o=t(3633),m=t(5237),x=t(3156),h=t(9176),u=t(5928),g=t(5264),y=t(2190),j=e=>{let{isOpen:s,onClose:t}=e,i=(0,l.useRouter)(),r=[{name:"Dashboard",href:"/",icon:d.Z},{name:"Upload Data",href:"/upload",icon:c.Z},{name:"Click Tracking",href:"/tracking",icon:o.Z},{name:"Manage Categories",href:"/manage-categories",icon:m.Z},{name:"Manage Items",href:"/manage-items",icon:x.Z},{name:"Manage Admins",href:"/manage-admins",icon:h.Z},{name:"Analytics",href:"/analytics",icon:u.Z},{name:"Settings",href:"/settings",icon:g.Z}];return(0,a.jsxs)(a.Fragment,{children:[s&&(0,a.jsx)("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-50 lg:hidden",onClick:t}),(0,a.jsxs)("div",{className:"\n        fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out\n        lg:translate-x-0 lg:static lg:inset-0\n        ".concat(s?"translate-x-0":"-translate-x-full","\n      "),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between h-16 px-6 border-b border-gray-200",children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-primary-600",children:"Taliyo Admin"}),(0,a.jsx)("button",{onClick:t,className:"lg:hidden p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100",children:(0,a.jsx)(y.Z,{size:20})})]}),(0,a.jsx)("nav",{className:"flex-1 px-4 py-6 space-y-2",children:r.map(e=>{let s=i.pathname===e.href;return(0,a.jsxs)(n(),{href:e.href,className:"\n                  flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200\n                  ".concat(s?"bg-primary-50 text-primary-600 border-r-2 border-primary-600":"text-gray-700 hover:bg-gray-100 hover:text-gray-900","\n                "),onClick:()=>t(),children:[(0,a.jsx)(e.icon,{size:20,className:"mr-3"}),e.name]},e.name)})}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,a.jsx)("div",{className:"text-xs text-gray-500 text-center",children:"Taliyo Admin Panel v1.0"})})]})]})},f=t(8497),p=t(7918),v=t(8267),b=t(775),N=t(4231),w=e=>{var s;let{onMenuClick:t,user:r}=e,[n,d]=(0,i.useState)(!1),c=(0,l.useRouter)(),o=()=>{try{(0,N.Jn)(),c.push("/login")}catch(e){console.error("Sign out error:",e)}};return(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16 px-6",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("button",{onClick:t,className:"p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 lg:hidden",children:(0,a.jsx)(f.Z,{size:20})}),(0,a.jsxs)("div",{className:"ml-4 lg:ml-0",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Welcome back, Admin"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Manage your Taliyo marketplace"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("button",{className:"p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 relative",children:[(0,a.jsx)(p.Z,{size:20}),(0,a.jsx)("span",{className:"absolute top-1 right-1 h-2 w-2 bg-red-500 rounded-full"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>d(!n),className:"flex items-center space-x-2 p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)("div",{className:"h-8 w-8 bg-primary-500 rounded-full flex items-center justify-center",children:(0,a.jsx)(v.Z,{size:16,className:"text-white"})}),(0,a.jsx)("span",{className:"hidden md:block text-sm font-medium text-gray-700",children:(null==r?void 0:null===(s=r.email)||void 0===s?void 0:s.split("@")[0])||"Admin"})]}),n&&(0,a.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-50",children:(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsxs)("div",{className:"px-4 py-2 text-sm text-gray-700 border-b border-gray-100",children:[(0,a.jsx)("div",{className:"font-medium",children:null==r?void 0:r.email}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Administrator"})]}),(0,a.jsxs)("button",{onClick:()=>{d(!1),c.push("/settings")},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)(g.Z,{size:16,className:"mr-2"}),"Settings"]}),(0,a.jsxs)("button",{onClick:()=>{d(!1),o()},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)(b.Z,{size:16,className:"mr-2"}),"Sign out"]})]})})]})]})]})})},k=e=>{let{children:s,user:t}=e,[r,n]=(0,i.useState)(!1);return(0,a.jsxs)("div",{className:"flex h-screen bg-gray-100",children:[(0,a.jsx)(j,{isOpen:r,onClose:()=>n(!1)}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,a.jsx)(w,{onMenuClick:()=>n(!0),user:t}),(0,a.jsx)("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-6",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto",children:s})})]})]})}},6259:function(e,s,t){"use strict";t.d(s,{O:function(){return d}});var a=t(4941),i=t(3454);let r="https://tbouqkdpsdkixrjfbukd.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRib3Vxa2Rwc2RraXhyamZidWtkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5NzU2MjQsImV4cCI6MjA3NTU1MTYyNH0.S7wo-mtBlIAO52Er72FSn7uyKZwqyzVvnz-46ik22Kg",l=i.env.SUPABASE_SERVICE_ROLE_KEY;if(!r||!n)throw Error("Missing Supabase environment variables");let d=(0,a.eI)(r,l||n,{auth:{autoRefreshToken:!1,persistSession:!1}});l&&(0,a.eI)(r,l,{auth:{autoRefreshToken:!1,persistSession:!1}})},8655:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(1134).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3050:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(1134).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6691:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(1134).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},4270:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(1134).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},3416:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(1134).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},7864:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(1134).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},7857:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return y}});var a=t(5893),i=t(7294),r=t(6880),n=t(4270),l=t(8655),d=t(2190),c=t(3050),o=t(6691),m=t(3416),x=t(7864),h=t(9176),u=t(6259);let g=["taliyotechnologies@gmail.com"];var y=e=>{let{user:s}=e,[t,y]=(0,i.useState)([]),[j,f]=(0,i.useState)(!0),[p,v]=(0,i.useState)(!1),[b,N]=(0,i.useState)(""),[w,k]=(0,i.useState)(!1),[Z,A]=(0,i.useState)(""),[C,_]=(0,i.useState)("");(0,i.useEffect)(()=>{s&&S()},[s]);let S=async()=>{try{let{data:e,error:s}=await u.O.from("admins").select("*").order("created_at",{ascending:!1});if(s)throw s;let t=g.map(e=>({id:e,email:e,is_active:!0,created_at:"2024-01-01",is_hardcoded:!0}));y([...t,...e||[]])}catch(e){console.error("Error loading admins:",e),A("Failed to load admin list")}finally{f(!1)}},z=async e=>{if(e.preventDefault(),b.trim()){k(!0),A(""),_("");try{if(t.find(e=>e.email.toLowerCase()===b.toLowerCase())){A("This email is already an admin");return}let{data:e,error:s}=await u.O.from("admins").insert([{email:b.toLowerCase(),is_active:!0}]).select().single();if(s)throw s;y([...t,e]),N(""),v(!1),_("Admin added successfully")}catch(e){console.error("Error adding admin:",e),A("Failed to add admin")}finally{k(!1)}}},E=async(e,s)=>{if(s){A("Cannot remove hardcoded system administrators");return}if(confirm("Are you sure you want to remove this admin?"))try{let{error:s}=await u.O.from("admins").delete().eq("id",e);if(s)throw s;y(t.filter(s=>s.id!==e)),_("Admin removed successfully")}catch(e){console.error("Error removing admin:",e),A("Failed to remove admin")}},I=async(e,s,a)=>{if(a){A("Cannot modify hardcoded system administrators");return}try{let{error:a}=await u.O.from("admins").update({is_active:!s}).eq("id",e);if(a)throw a;y(t.map(t=>t.id===e?{...t,is_active:!s}:t)),_("Admin ".concat(s?"deactivated":"activated"," successfully"))}catch(e){console.error("Error updating admin status:",e),A("Failed to update admin status")}};return s?(0,a.jsx)(r.Z,{user:s,children:(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Manage Admins"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Control who has access to the admin panel."})]}),(0,a.jsxs)("button",{onClick:()=>v(!0),className:"btn-primary flex items-center",children:[(0,a.jsx)(n.Z,{size:16,className:"mr-2"}),"Add Admin"]})]}),Z&&(0,a.jsx)("div",{className:"alert-error",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(l.Z,{size:20,className:"mr-2 mt-0.5 flex-shrink-0"}),(0,a.jsx)("span",{children:Z}),(0,a.jsx)("button",{onClick:()=>A(""),className:"ml-auto",children:(0,a.jsx)(d.Z,{size:16})})]})}),C&&(0,a.jsx)("div",{className:"alert-success",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(c.Z,{size:20,className:"mr-2 mt-0.5 flex-shrink-0"}),(0,a.jsx)("span",{children:C}),(0,a.jsx)("button",{onClick:()=>_(""),className:"ml-auto",children:(0,a.jsx)(d.Z,{size:16})})]})}),p&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Add New Admin"}),(0,a.jsxs)("form",{onSubmit:z,children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"form-label",children:"Email Address"}),(0,a.jsx)("input",{type:"email",value:b,onChange:e=>N(e.target.value),className:"form-input",placeholder:"admin@example.com",required:!0})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{v(!1),N(""),A("")},className:"btn-secondary",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:w,className:"btn-primary ".concat(w?"opacity-50 cursor-not-allowed":""),children:w?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"loading-spinner mr-2"}),"Adding..."]}):"Add Admin"})]})]})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Admin Users"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[t.filter(e=>e.is_active).length," active admins"]})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:j?(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"loading-spinner mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading admins..."})]}):t.length>0?(0,a.jsxs)("table",{className:"table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Email"}),(0,a.jsx)("th",{children:"Status"}),(0,a.jsx)("th",{children:"Type"}),(0,a.jsx)("th",{children:"Added"}),(0,a.jsx)("th",{children:"Actions"})]})}),(0,a.jsx)("tbody",{children:t.map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"h-8 w-8 bg-primary-100 rounded-full flex items-center justify-center mr-3",children:(0,a.jsx)(o.Z,{size:14,className:"text-primary-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.email}),e.email===(null==s?void 0:s.email)&&(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"You"})]})]})}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Active":"Inactive"})}),(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(m.Z,{size:14,className:"mr-1 ".concat(e.is_hardcoded?"text-orange-500":"text-blue-500")}),(0,a.jsx)("span",{className:"text-xs ".concat(e.is_hardcoded?"text-orange-600":"text-blue-600"),children:e.is_hardcoded?"System":"Added"})]})}),(0,a.jsx)("td",{children:(0,a.jsx)("div",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})}),(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[!e.is_hardcoded&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>I(e.id,e.is_active,e.is_hardcoded),className:"text-xs px-2 py-1 rounded ".concat(e.is_active?"bg-red-100 text-red-600 hover:bg-red-200":"bg-green-100 text-green-600 hover:bg-green-200"),children:e.is_active?"Deactivate":"Activate"}),(0,a.jsx)("button",{onClick:()=>E(e.id,e.is_hardcoded),className:"text-red-600 hover:text-red-800",children:(0,a.jsx)(x.Z,{size:14})})]}),e.is_hardcoded&&(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"Protected"})]})})]},e.id||t))})]}):(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)(h.Z,{size:48,className:"mx-auto text-gray-300 mb-3"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No admins found"})]})})]}),(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg border border-blue-200 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Admin Access Control"}),(0,a.jsxs)("div",{className:"text-sm text-blue-800 space-y-2",children:[(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"System Admins:"})," Hardcoded administrators that cannot be removed"]}),(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"Added Admins:"})," Administrators added through this panel"]}),(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"Active Status:"})," Only active admins can access the panel"]}),(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"Email Verification:"})," Admins must sign in with their registered email"]})]})]})]})}):null}}},function(e){e.O(0,[941,736,888,774,179],function(){return e(e.s=2738)}),_N_E=e.O()}]);